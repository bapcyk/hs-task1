<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "HTTP://WWW.W3.ORG/TR/REC-HTML40/STRICT.DTD"><html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="task1.css" type="text/css" media="all"><title>Diff between revisions HEAD~10..HEAD</title></head><body><h1><span class="lambda">&lambda;</span>Diff between revisions HEAD~10..HEAD</h1><div class="file filea"><b>FILE A: </b>app/Main.hs</div><div class="file fileb"><b>FILE B: </b>app/Main.hs</div><div class="range rangea"><b>FILE A: </b>16.. (6)</div><div class="range rangeb"><b>FILE B: </b>16.. (7)</div><div class="line unmodified"><div class="ln lnA">16</div><div class="ln lnB">16</div>, &nbsp; badwords &nbsp; :: &nbsp; !String &nbsp; -- &nbsp; bad &nbsp; words</div><div class="line unmodified"><div class="ln lnA">17</div><div class="ln lnB">17</div>, &nbsp; output &nbsp;&nbsp;&nbsp; :: &nbsp; !String &nbsp; -- &nbsp; output &nbsp; HTML &nbsp; file</div><div class="line unmodified"><div class="ln lnA">18</div><div class="ln lnB">18</div>, &nbsp; git &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :: &nbsp; !String &nbsp; -- &nbsp; path &nbsp; to &nbsp; Git &nbsp; binary</div><div class="line added"><div class="ln lnA">19</div><div class="ln lnB">19</div>, &nbsp; exts &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :: &nbsp; !String &nbsp; -- &nbsp; file &nbsp; extensions</div><div class="line unmodified"><div class="ln lnA">19</div><div class="ln lnB">20</div>&nbsp;&nbsp; } &nbsp; deriving &nbsp; Show</div><div class="line unmodified"><div class="ln lnA">20</div><div class="ln lnB">21</div></div><div class="line unmodified"><div class="ln lnA">21</div><div class="ln lnB">22</div></div><div class="range rangea"><b>FILE A: </b>28.. (6)</div><div class="range rangeb"><b>FILE B: </b>29.. (7)</div><div class="line unmodified"><div class="ln lnA">28</div><div class="ln lnB">29</div>, &nbsp; badwords &nbsp; = &nbsp; ""</div><div class="line unmodified"><div class="ln lnA">29</div><div class="ln lnB">30</div>, &nbsp; output &nbsp; = &nbsp; "output.html"</div><div class="line unmodified"><div class="ln lnA">30</div><div class="ln lnB">31</div>, &nbsp; git &nbsp; = &nbsp; "git"</div><div class="line added"><div class="ln lnA">31</div><div class="ln lnB">32</div>, &nbsp; exts &nbsp; = &nbsp; ""</div><div class="line unmodified"><div class="ln lnA">31</div><div class="ln lnB">33</div>&nbsp;&nbsp; }</div><div class="line unmodified"><div class="ln lnA">32</div><div class="ln lnB">34</div></div><div class="line unmodified"><div class="ln lnA">33</div><div class="ln lnB">35</div></div><div class="range rangea"><b>FILE A: </b>58.. (6)</div><div class="range rangeb"><b>FILE B: </b>60.. (10)</div><div class="line unmodified"><div class="ln lnA">58</div><div class="ln lnB">60</div>&nbsp;&nbsp; , &nbsp; Option &nbsp; ['g'] &nbsp; ["git"]</div><div class="line unmodified"><div class="ln lnA">59</div><div class="ln lnB">61</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ReqArg &nbsp; (\a &nbsp; opts &nbsp; -&gt; &nbsp; opts &nbsp; {git=a}) &nbsp; "PATH")</div><div class="line unmodified"><div class="ln lnA">60</div><div class="ln lnB">62</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "path &nbsp; to &nbsp; Git &nbsp; binary &nbsp; (default: &nbsp; git)"</div><div class="line added"><div class="ln lnA">61</div><div class="ln lnB">63</div></div><div class="line added"><div class="ln lnA">61</div><div class="ln lnB">64</div>&nbsp;&nbsp; , &nbsp; Option &nbsp; ['x'] &nbsp; ["exts"]</div><div class="line added"><div class="ln lnA">61</div><div class="ln lnB">65</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ReqArg &nbsp; (\a &nbsp; opts &nbsp; -&gt; &nbsp; opts &nbsp; {exts=a}) &nbsp; "STR")</div><div class="line added"><div class="ln lnA">61</div><div class="ln lnB">66</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "extensions, &nbsp; string &nbsp; like &nbsp; \"*.cpp &nbsp; *.hpp\" &nbsp; (default: &nbsp; all)"</div><div class="line unmodified"><div class="ln lnA">61</div><div class="ln lnB">67</div>&nbsp;&nbsp; ]</div><div class="line unmodified"><div class="ln lnA">62</div><div class="ln lnB">68</div></div><div class="line unmodified"><div class="ln lnA">63</div><div class="ln lnB">69</div></div><div class="range rangea"><b>FILE A: </b>87.. (5)</div><div class="range rangeb"><b>FILE B: </b>93.. (6)</div><div class="line unmodified"><div class="ln lnA">87</div><div class="ln lnB">93</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt; &nbsp; exitFailure</div><div class="line unmodified"><div class="ln lnA">88</div><div class="ln lnB">94</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else &nbsp; <span class="highlight">do</span></div><div class="line unmodified"><div class="ln lnA">89</div><div class="ln lnB">95</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gitHtmlDiff &nbsp; (rev0 &nbsp; cmdOpts) &nbsp; (rev1 &nbsp; cmdOpts) &nbsp; (git &nbsp; cmdOpts)</div><div class="line deleted"><div class="ln lnA">90</div><div class="ln lnB">96</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (words &nbsp; $ &nbsp; badwords &nbsp; cmdOpts)</div><div class="line added"><div class="ln lnA">91</div><div class="ln lnB">96</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (words &nbsp; $ &nbsp; badwords &nbsp; cmdOpts) &nbsp; (words &nbsp; $ &nbsp; exts &nbsp; cmdOpts)</div><div class="line unmodified"><div class="ln lnA">91</div><div class="ln lnB">97</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt;= &nbsp; writeFile &nbsp; (output &nbsp; cmdOpts)</div><div class="line added"><div class="ln lnA">92</div><div class="ln lnB">98</div>&nbsp;&nbsp; -- &nbsp; XYZ &nbsp; тест &nbsp; юникод</div><div class="file filea"><b>FILE A: </b>src/Lib.hs</div><div class="file fileb"><b>FILE B: </b>src/Lib.hs</div><div class="range rangea"><b>FILE A: </b>74.. (15)</div><div class="range rangeb"><b>FILE B: </b>74.. (17)</div><div class="line unmodified"><div class="ln lnA">74</div><div class="ln lnB">74</div>data &nbsp; OutItem &nbsp; =</div><div class="line unmodified"><div class="ln lnA">75</div><div class="ln lnB">75</div>&nbsp;&nbsp; OutFiles &nbsp; DiffFiles &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; comparing &nbsp; files</div><div class="line unmodified"><div class="ln lnA">76</div><div class="ln lnB">76</div>&nbsp;&nbsp; | &nbsp; OutRange &nbsp; DiffRange &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; hunk &nbsp; range</div><div class="line deleted"><div class="ln lnA">77</div><div class="ln lnB">77</div>&nbsp;&nbsp; | &nbsp; OutLine &nbsp; ChangeAction &nbsp; OutStr &nbsp; Integer &nbsp; -- &nbsp; (change, &nbsp; list-of-hi-words, &nbsp; hunk-line-num)</div><div class="line added"><div class="ln lnA">78</div><div class="ln lnB">77</div>&nbsp;&nbsp; -- &nbsp; (change, &nbsp; list-of-hi-words, &nbsp; hunk-line-num-fileA, &nbsp; hunk-line-num-fileB)</div><div class="line added"><div class="ln lnA">78</div><div class="ln lnB">78</div>&nbsp;&nbsp; | &nbsp; OutLine &nbsp; ChangeAction &nbsp; OutStr &nbsp; Integer &nbsp; Integer</div><div class="line unmodified"><div class="ln lnA">78</div><div class="ln lnB">79</div>&nbsp;&nbsp; deriving &nbsp; Show</div><div class="line unmodified"><div class="ln lnA">79</div><div class="ln lnB">80</div></div><div class="line unmodified"><div class="ln lnA">80</div><div class="ln lnB">81</div></div><div class="line unmodified"><div class="ln lnA">81</div><div class="ln lnB">82</div>-- &nbsp; | &nbsp; Context &nbsp; of &nbsp; iteration &nbsp; over &nbsp; diff &nbsp; lines</div><div class="line unmodified"><div class="ln lnA">82</div><div class="ln lnB">83</div>data &nbsp; Ctx &nbsp; = &nbsp; Ctx &nbsp; {</div><div class="line deleted"><div class="ln lnA">83</div><div class="ln lnB">84</div>&nbsp;&nbsp; files &nbsp; :: &nbsp; DiffFiles &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; comparing &nbsp; files</div><div class="line added"><div class="ln lnA">84</div><div class="ln lnB">84</div>&nbsp;&nbsp; files &nbsp; :: &nbsp; DiffFiles &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; comparing &nbsp; files</div><div class="line unmodified"><div class="ln lnA">84</div><div class="ln lnB">85</div>&nbsp;&nbsp; ,range &nbsp; :: &nbsp; DiffRange &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; hunk &nbsp; range</div><div class="line deleted"><div class="ln lnA">85</div><div class="ln lnB">86</div>&nbsp;&nbsp; ,hunkLineNum &nbsp; :: &nbsp; Integer &nbsp; -- &nbsp; <span class="highlight">line</span> &nbsp; number &nbsp; in &nbsp; the &nbsp; hunk</div><div class="line added"><div class="ln lnA">86</div><div class="ln lnB">86</div>&nbsp;&nbsp; ,lnA &nbsp; :: &nbsp; Integer &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; <span class="highlight">line</span> &nbsp; number &nbsp; in &nbsp; the &nbsp; hunk &nbsp; of &nbsp; file &nbsp; A</div><div class="line added"><div class="ln lnA">86</div><div class="ln lnB">87</div>&nbsp;&nbsp; ,lnB &nbsp; :: &nbsp; Integer &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; <span class="highlight">line</span> &nbsp; number &nbsp; in &nbsp; the &nbsp; hunk &nbsp; of &nbsp; file &nbsp; B</div><div class="line unmodified"><div class="ln lnA">86</div><div class="ln lnB">88</div>&nbsp;&nbsp; ,outItems &nbsp; :: &nbsp; [OutItem] &nbsp;&nbsp; -- &nbsp; output &nbsp; items</div><div class="line unmodified"><div class="ln lnA">87</div><div class="ln lnB">89</div>&nbsp;&nbsp; ,badWords &nbsp; :: &nbsp; [String] &nbsp;&nbsp;&nbsp; -- &nbsp; "bad" &nbsp; words &nbsp; (to &nbsp; be &nbsp; highlighted)</div><div class="line unmodified"><div class="ln lnA">88</div><div class="ln lnB">90</div>&nbsp;&nbsp; } &nbsp; deriving &nbsp; Show</div><div class="range rangea"><b>FILE A: </b>230.. (31)</div><div class="range rangeb"><b>FILE B: </b>232.. (43)</div><div class="line unmodified"><div class="ln lnA">230</div><div class="ln lnB">232</div></div><div class="line unmodified"><div class="ln lnA">231</div><div class="ln lnB">233</div>-- &nbsp; | &nbsp; Creates &nbsp; empty &nbsp; context &nbsp; w/ &nbsp; bad &nbsp; words &nbsp; `bw`</div><div class="line unmodified"><div class="ln lnA">232</div><div class="ln lnB">234</div>emptyCtx &nbsp; :: &nbsp; [String] &nbsp; -&gt; &nbsp; Ctx</div><div class="line deleted"><div class="ln lnA">233</div><div class="ln lnB">235</div>emptyCtx &nbsp; bw &nbsp; = &nbsp; Ctx &nbsp; (DiffFiles &nbsp; "" &nbsp; "") &nbsp; (DiffRange &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0) &nbsp; 0 &nbsp; [] &nbsp; bw</div><div class="line added"><div class="ln lnA">234</div><div class="ln lnB">235</div>emptyCtx &nbsp; bw &nbsp; = &nbsp; Ctx &nbsp; (DiffFiles &nbsp; "" &nbsp; "") &nbsp; (DiffRange &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0) &nbsp; 0 &nbsp; 0 &nbsp; [] &nbsp; bw</div><div class="line unmodified"><div class="ln lnA">234</div><div class="ln lnB">236</div></div><div class="line unmodified"><div class="ln lnA">235</div><div class="ln lnB">237</div></div><div class="line unmodified"><div class="ln lnA">236</div><div class="ln lnB">238</div>-- &nbsp; | &nbsp; Processes &nbsp; one &nbsp; input &nbsp; <span class="highlight">line</span> &nbsp; from &nbsp; diff &nbsp; output</div><div class="line unmodified"><div class="ln lnA">237</div><div class="ln lnB">239</div>procDiffLine &nbsp; :: &nbsp; Ctx &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; Ctx</div><div class="line unmodified"><div class="ln lnA">238</div><div class="ln lnB">240</div>procDiffLine &nbsp; ctx &nbsp; s &nbsp; =</div><div class="line deleted"><div class="ln lnA">239</div><div class="ln lnB">241</div>&nbsp;&nbsp; case &nbsp; readMaybe &nbsp; s &nbsp; :: &nbsp; Maybe &nbsp; Marker &nbsp; of</div><div class="line deleted"><div class="ln lnA">240</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp; Nothing &nbsp; -&gt; &nbsp; ctx</div><div class="line deleted"><div class="ln lnA">241</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp; Just &nbsp; (LineMarker &nbsp; l) &nbsp; -&gt; &nbsp; ctx &nbsp; {</div><div class="line deleted"><div class="ln lnA">242</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; TODO &nbsp; 0 &nbsp; - &nbsp; linenum &nbsp; in &nbsp; hunk</div><div class="line deleted"><div class="ln lnA">243</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; outItems=(outItems &nbsp; ctx)++[OutLine &nbsp; (change &nbsp; l) &nbsp; (hiWords &nbsp; (badWords &nbsp; ctx) &nbsp; (line &nbsp; l)) &nbsp; 0]</div><div class="line deleted"><div class="ln lnA">244</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</div><div class="line deleted"><div class="ln lnA">245</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp; Just &nbsp; (RangeMarker &nbsp; r) &nbsp; -&gt; &nbsp; ctx &nbsp; {</div><div class="line deleted"><div class="ln lnA">246</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; range=r</div><div class="line deleted"><div class="ln lnA">247</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,outItems=(outItems &nbsp; ctx)++[OutRange &nbsp; r]} &nbsp; -- &nbsp; time &nbsp; for &nbsp; lense &nbsp; ;)</div><div class="line deleted"><div class="ln lnA">248</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp; Just &nbsp; (FilesMarker &nbsp; f) &nbsp; -&gt; &nbsp; ctx &nbsp; {</div><div class="line deleted"><div class="ln lnA">249</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; files=f</div><div class="line deleted"><div class="ln lnA">250</div><div class="ln lnB">241</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,outItems=(outItems &nbsp; ctx)++[OutFiles &nbsp; f]}</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">241</div>&nbsp;&nbsp; let</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">242</div>&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; | &nbsp; Calculates &nbsp; incremenent &nbsp; of &nbsp; lnA, &nbsp; lnB:</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">243</div>&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; Add &nbsp; - &nbsp; incremenents &nbsp; lnB, &nbsp; Del &nbsp; - &nbsp; lnA, &nbsp; +1 &nbsp; to &nbsp; all &nbsp; after &nbsp; iterate &nbsp; over &nbsp; <span class="highlight">line</span></div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">244</div>&nbsp;&nbsp;&nbsp;&nbsp; lnInc &nbsp; (DiffLine &nbsp; Add &nbsp; _) &nbsp; = &nbsp; (0, &nbsp; 1)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">245</div>&nbsp;&nbsp;&nbsp;&nbsp; lnInc &nbsp; (DiffLine &nbsp; Del &nbsp; _) &nbsp; = &nbsp; (1, &nbsp; 0)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">246</div>&nbsp;&nbsp;&nbsp;&nbsp; lnInc &nbsp; (DiffLine &nbsp; _ &nbsp;&nbsp;&nbsp; _) &nbsp; = &nbsp; (1, &nbsp; 1)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">247</div>&nbsp;&nbsp; in</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">248</div>&nbsp;&nbsp;&nbsp;&nbsp; case &nbsp; readMaybe &nbsp; s &nbsp; :: &nbsp; Maybe &nbsp; Marker &nbsp; of</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">249</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp; time &nbsp; for &nbsp; lense &nbsp; ;)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">250</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nothing &nbsp; -&gt; &nbsp; ctx</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">251</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Just &nbsp; (LineMarker &nbsp; l) &nbsp; -&gt; &nbsp; ctx &nbsp; {</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">252</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; outItems=(outItems &nbsp; ctx)++[OutLine &nbsp; (change &nbsp; l) &nbsp; (hiWords &nbsp; (badWords &nbsp; ctx) &nbsp; (line &nbsp; l))</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">253</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (lnA &nbsp; ctx) &nbsp; (lnB &nbsp; ctx)]</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">254</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,lnA=(incA+lnA &nbsp; ctx)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">255</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,lnB=(incB+lnB &nbsp; ctx)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">256</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp; where &nbsp; (incA, &nbsp; incB) &nbsp; = &nbsp; lnInc &nbsp; l</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">257</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Just &nbsp; (RangeMarker &nbsp; r) &nbsp; -&gt; &nbsp; ctx &nbsp; {</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">258</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; range=r</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">259</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,outItems=(outItems &nbsp; ctx)++[OutRange &nbsp; r]</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">260</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,lnA=(begA &nbsp; r)</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">261</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,lnB=(begB &nbsp; r)}</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">262</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Just &nbsp; (FilesMarker &nbsp; f) &nbsp; -&gt; &nbsp; ctx &nbsp; {</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">263</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; files=f</div><div class="line added"><div class="ln lnA">251</div><div class="ln lnB">264</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,outItems=(outItems &nbsp; ctx)++[OutFiles &nbsp; f]}</div><div class="line unmodified"><div class="ln lnA">251</div><div class="ln lnB">265</div></div><div class="line unmodified"><div class="ln lnA">252</div><div class="ln lnB">266</div></div><div class="line unmodified"><div class="ln lnA">253</div><div class="ln lnB">267</div>------------------------------ &nbsp; HTML &nbsp; output &nbsp; utilities &nbsp; --------------------------</div><div class="line unmodified"><div class="ln lnA">254</div><div class="ln lnB">268</div></div><div class="line unmodified"><div class="ln lnA">255</div><div class="ln lnB">269</div>-- &nbsp; | &nbsp; Escapes &nbsp; string &nbsp; `s` &nbsp; to &nbsp; be &nbsp; HTML &nbsp; safe</div><div class="line unmodified"><div class="ln lnA">256</div><div class="ln lnB">270</div>escHtml &nbsp; :: &nbsp; String &nbsp; -&gt; &nbsp; String</div><div class="line deleted"><div class="ln lnA">257</div><div class="ln lnB">271</div>escHtml &nbsp; s &nbsp; = &nbsp; intercalate &nbsp; "" &nbsp; $ &nbsp; map &nbsp; repl &nbsp; s</div><div class="line added"><div class="ln lnA">258</div><div class="ln lnB">271</div>escHtml &nbsp; = &nbsp; intercalate &nbsp; "" &nbsp; . &nbsp; map &nbsp; repl</div><div class="line unmodified"><div class="ln lnA">258</div><div class="ln lnB">272</div>&nbsp;&nbsp; where</div><div class="line unmodified"><div class="ln lnA">259</div><div class="ln lnB">273</div>&nbsp;&nbsp;&nbsp;&nbsp; repl &nbsp; '\n' &nbsp; = &nbsp; "&lt;br/&gt;"</div><div class="line unmodified"><div class="ln lnA">260</div><div class="ln lnB">274</div>&nbsp;&nbsp;&nbsp;&nbsp; repl &nbsp; '\t' &nbsp; = &nbsp; "&amp;emsp;"</div><div class="range rangea"><b>FILE A: </b>268.. (15)</div><div class="range rangeb"><b>FILE B: </b>282.. (18)</div><div class="line unmodified"><div class="ln lnA">268</div><div class="ln lnB">282</div>-- &nbsp; | &nbsp; Show &nbsp; OutItem &nbsp; as &nbsp; HTML</div><div class="line unmodified"><div class="ln lnA">269</div><div class="ln lnB">283</div>instance &nbsp; ShowHtml &nbsp; OutItem &nbsp; where</div><div class="line unmodified"><div class="ln lnA">270</div><div class="ln lnB">284</div>&nbsp;&nbsp; showHtml &nbsp; (OutFiles &nbsp; f) &nbsp; =</div><div class="line deleted"><div class="ln lnA">271</div><div class="ln lnB">285</div>&nbsp;&nbsp;&nbsp;&nbsp; ("&lt;div &nbsp; class=\"filea\"&gt;&lt;b&gt;FILE &nbsp; A: &nbsp; &lt;/b&gt;"++(fileA &nbsp; f)++"&lt;/div&gt;"</div><div class="line deleted"><div class="ln lnA">272</div><div class="ln lnB">285</div>&nbsp;&nbsp;&nbsp;&nbsp; ++ &nbsp; "&lt;div &nbsp; class=\"fileb\"&gt;&lt;b&gt;FILE &nbsp; B: &nbsp; &lt;/b&gt;"++(fileB &nbsp; f)++"&lt;/div&gt;")</div><div class="line added"><div class="ln lnA">273</div><div class="ln lnB">285</div>&nbsp;&nbsp;&nbsp;&nbsp; ("&lt;div &nbsp; class=\"file &nbsp; filea\"&gt;&lt;b&gt;FILE &nbsp; A: &nbsp; &lt;/b&gt;"++(fileA &nbsp; f)++"&lt;/div&gt;"</div><div class="line added"><div class="ln lnA">273</div><div class="ln lnB">286</div>&nbsp;&nbsp;&nbsp;&nbsp; ++ &nbsp; "&lt;div &nbsp; class=\"file &nbsp; fileb\"&gt;&lt;b&gt;FILE &nbsp; B: &nbsp; &lt;/b&gt;"++(fileB &nbsp; f)++"&lt;/div&gt;")</div><div class="line unmodified"><div class="ln lnA">273</div><div class="ln lnB">287</div>&nbsp;&nbsp; showHtml &nbsp; (OutRange &nbsp; r) &nbsp; =</div><div class="line deleted"><div class="ln lnA">274</div><div class="ln lnB">288</div>&nbsp;&nbsp;&nbsp;&nbsp; ("&lt;div &nbsp; class=\"range\"&gt;&lt;b&gt;CHANGE &nbsp; OF &nbsp; FILE &nbsp; A &nbsp; - &nbsp; from/len: &nbsp; &lt;/b&gt;"++(show &nbsp; $ &nbsp; begA &nbsp; r)</div><div class="line deleted"><div class="ln lnA">275</div><div class="ln lnB">288</div>&nbsp;&nbsp;&nbsp;&nbsp; ++"/"++(show &nbsp; $ &nbsp; lenA &nbsp; r)++"&lt;/div&gt;"</div><div class="line deleted"><div class="ln lnA">276</div><div class="ln lnB">288</div>&nbsp;&nbsp;&nbsp;&nbsp; ++"&lt;div &nbsp; class=\"range\"&gt;&lt;b&gt;CHANGE &nbsp; OF &nbsp; FILE &nbsp; B &nbsp; - &nbsp; from/len: &nbsp; &lt;/b&gt;"++(show &nbsp; $ &nbsp; begB &nbsp; r)</div><div class="line deleted"><div class="ln lnA">277</div><div class="ln lnB">288</div>&nbsp;&nbsp;&nbsp;&nbsp; ++"/"++(show &nbsp; $ &nbsp; lenB &nbsp; r)++"&lt;/div&gt;")</div><div class="line deleted"><div class="ln lnA">278</div><div class="ln lnB">288</div>&nbsp;&nbsp; showHtml &nbsp; (OutLine &nbsp; ca &nbsp; os &nbsp; ln) &nbsp; =</div><div class="line deleted"><div class="ln lnA">279</div><div class="ln lnB">288</div>&nbsp;&nbsp;&nbsp;&nbsp; "&lt;div &nbsp; class=\"line &nbsp; "++(cls &nbsp; ca)++"\"&gt;"++(intercalate &nbsp; " &nbsp; " &nbsp; $ &nbsp; map &nbsp; hi &nbsp; os)++"&lt;/div&gt;"</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">288</div>&nbsp;&nbsp;&nbsp;&nbsp; ("&lt;div &nbsp; class=\"range &nbsp; rangea\"&gt;&lt;b&gt;FILE &nbsp; A: &nbsp; &lt;/b&gt;"++(show &nbsp; $ &nbsp; begA &nbsp; r)</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">289</div>&nbsp;&nbsp;&nbsp;&nbsp; ++".. &nbsp; ("++(show &nbsp; $ &nbsp; lenA &nbsp; r)++")&lt;/div&gt;"</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">290</div>&nbsp;&nbsp;&nbsp;&nbsp; ++"&lt;div &nbsp; class=\"range &nbsp; rangeb\"&gt;&lt;b&gt;FILE &nbsp; B: &nbsp; &lt;/b&gt;"++(show &nbsp; $ &nbsp; begB &nbsp; r)</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">291</div>&nbsp;&nbsp;&nbsp;&nbsp; ++".. &nbsp; ("++(show &nbsp; $ &nbsp; lenB &nbsp; r)++")&lt;/div&gt;")</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">292</div>&nbsp;&nbsp; showHtml &nbsp; (OutLine &nbsp; ca &nbsp; os &nbsp; lnA &nbsp; lnB) &nbsp; =</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">293</div>&nbsp;&nbsp;&nbsp;&nbsp; "&lt;div &nbsp; class=\"line &nbsp; "++(cls &nbsp; ca)++"\"&gt;"</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">294</div>&nbsp;&nbsp;&nbsp;&nbsp; ++"&lt;div &nbsp; class=\"ln &nbsp; lnA\"&gt;"++(show &nbsp; lnA)++"&lt;/div&gt;"</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">295</div>&nbsp;&nbsp;&nbsp;&nbsp; ++"&lt;div &nbsp; class=\"ln &nbsp; lnB\"&gt;"++(show &nbsp; lnB)++"&lt;/div&gt;"</div><div class="line added"><div class="ln lnA">280</div><div class="ln lnB">296</div>&nbsp;&nbsp;&nbsp;&nbsp; ++(intercalate &nbsp; " &nbsp; " &nbsp; $ &nbsp; map &nbsp; hi &nbsp; os)++"&lt;/div&gt;"</div><div class="line unmodified"><div class="ln lnA">280</div><div class="ln lnB">297</div>&nbsp;&nbsp;&nbsp;&nbsp; where &nbsp; hi &nbsp; (HiStr &nbsp; s) &nbsp; = &nbsp; "&lt;span &nbsp; class=\"highlight\"&gt;"++(escHtml &nbsp; s)++"&lt;/span&gt;"</div><div class="line unmodified"><div class="ln lnA">281</div><div class="ln lnB">298</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hi &nbsp; (LoStr &nbsp; s) &nbsp; = &nbsp; escHtml &nbsp; s</div><div class="line unmodified"><div class="ln lnA">282</div><div class="ln lnB">299</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cls &nbsp; Add &nbsp; = &nbsp; "added"</div><div class="range rangea"><b>FILE A: </b>291.. (12)</div><div class="range rangeb"><b>FILE B: </b>308.. (15)</div><div class="line unmodified"><div class="ln lnA">291</div><div class="ln lnB">308</div></div><div class="line unmodified"><div class="ln lnA">292</div><div class="ln lnB">309</div>-- &nbsp; | &nbsp; HTML &nbsp; header</div><div class="line unmodified"><div class="ln lnA">293</div><div class="ln lnB">310</div>htmlHeader &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; =</div><div class="line deleted"><div class="ln lnA">294</div><div class="ln lnB">311</div>&nbsp;&nbsp; ("&lt;!DOCTYPE &nbsp; HTML &nbsp; PUBLIC &nbsp; \"-//W3C//DTD &nbsp; HTML &nbsp; 4.0//EN\" &nbsp; \"HTTP://WWW.W3.ORG/TR/REC-HTML40/STRICT.DTD\"&gt;"</div><div class="line added"><div class="ln lnA">295</div><div class="ln lnB">311</div>&nbsp;&nbsp;&nbsp; "&lt;!DOCTYPE &nbsp; HTML &nbsp; PUBLIC &nbsp; \"-//W3C//DTD &nbsp; HTML &nbsp; 4.0//EN\" &nbsp; \"HTTP://WWW.W3.ORG/TR/REC-HTML40/STRICT.DTD\"&gt;"</div><div class="line unmodified"><div class="ln lnA">295</div><div class="ln lnB">312</div>&nbsp;&nbsp;&nbsp; ++"&lt;html&gt;&lt;head&gt;"</div><div class="line deleted"><div class="ln lnA">296</div><div class="ln lnB">313</div>&nbsp;&nbsp;&nbsp; ++"&lt;meta &nbsp; http-equiv=\"content-type\" &nbsp; content=\"text/html; &nbsp; charset=ISO-8859-1\"&gt;"</div><div class="line deleted"><div class="ln lnA">297</div><div class="ln lnB">313</div>&nbsp;&nbsp;&nbsp; ++"&lt;link &nbsp; rel=\"stylesheet\" &nbsp; href=\"task2.css\" &nbsp; type=\"text/css\" &nbsp; media=\"all\"&gt;"</div><div class="line added"><div class="ln lnA">298</div><div class="ln lnB">313</div>&nbsp;&nbsp;&nbsp; ++"&lt;meta &nbsp; http-equiv=\"content-type\" &nbsp; content=\"text/html; &nbsp; charset=UTF-8\"&gt;"</div><div class="line added"><div class="ln lnA">298</div><div class="ln lnB">314</div>&nbsp;&nbsp;&nbsp; ++"&lt;link &nbsp; rel=\"stylesheet\" &nbsp; href=\"task1.css\" &nbsp; type=\"text/css\" &nbsp; media=\"all\"&gt;"</div><div class="line unmodified"><div class="ln lnA">298</div><div class="ln lnB">315</div>&nbsp;&nbsp;&nbsp; ++"&lt;title&gt;Diff &nbsp; between &nbsp; revisions &nbsp; "++rev0++".."++rev1++"&lt;/title&gt;"</div><div class="line deleted"><div class="ln lnA">299</div><div class="ln lnB">316</div>&nbsp;&nbsp;&nbsp; ++"&lt;/head&gt;&lt;body&gt;")</div><div class="line added"><div class="ln lnA">300</div><div class="ln lnB">316</div>&nbsp;&nbsp;&nbsp; ++"&lt;/head&gt;&lt;body&gt;"</div><div class="line added"><div class="ln lnA">300</div><div class="ln lnB">317</div>&nbsp;&nbsp;&nbsp; ++"&lt;h1&gt;"</div><div class="line added"><div class="ln lnA">300</div><div class="ln lnB">318</div>&nbsp;&nbsp;&nbsp; ++"&lt;span &nbsp; class=\"lambda\"&gt;&amp;lambda;&lt;/span&gt;"</div><div class="line added"><div class="ln lnA">300</div><div class="ln lnB">319</div>&nbsp;&nbsp;&nbsp; ++"Diff &nbsp; between &nbsp; revisions &nbsp; "++rev0++".."++rev1++"&lt;/h1&gt;"</div><div class="line unmodified"><div class="ln lnA">300</div><div class="ln lnB">320</div></div><div class="line unmodified"><div class="ln lnA">301</div><div class="ln lnB">321</div></div><div class="line unmodified"><div class="ln lnA">302</div><div class="ln lnB">322</div>-- &nbsp; | &nbsp; HTML &nbsp; footer</div><div class="range rangea"><b>FILE A: </b>306.. (9)</div><div class="range rangeb"><b>FILE B: </b>326.. (12)</div><div class="line unmodified"><div class="ln lnA">306</div><div class="ln lnB">326</div>---------------------------------- &nbsp; Git &nbsp; utilities &nbsp; ------------------------------</div><div class="line unmodified"><div class="ln lnA">307</div><div class="ln lnB">327</div></div><div class="line unmodified"><div class="ln lnA">308</div><div class="ln lnB">328</div>-- &nbsp; | &nbsp; Get &nbsp; diff &nbsp; between &nbsp; revision &nbsp; `rev0`..`rev1` &nbsp; of &nbsp; local &nbsp; master &nbsp; branch</div><div class="line deleted"><div class="ln lnA">309</div><div class="ln lnB">329</div>gitdiff &nbsp; :: &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; IO &nbsp; String</div><div class="line deleted"><div class="ln lnA">310</div><div class="ln lnB">329</div>gitdiff &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; gitbin &nbsp; = &nbsp; <span class="highlight">do</span></div><div class="line deleted"><div class="ln lnA">311</div><div class="ln lnB">329</div>&nbsp;&nbsp; readProcess &nbsp; gitbin &nbsp; ["diff",rev0++".."++rev1] &nbsp; []</div><div class="line added"><div class="ln lnA">312</div><div class="ln lnB">329</div>gitdiff &nbsp; :: &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; [String] &nbsp; -&gt; &nbsp; IO &nbsp; String</div><div class="line added"><div class="ln lnA">312</div><div class="ln lnB">330</div>gitdiff &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; gitbin &nbsp; exts &nbsp; = &nbsp; <span class="highlight">do</span></div><div class="line added"><div class="ln lnA">312</div><div class="ln lnB">331</div>&nbsp;&nbsp; readProcess &nbsp; gitbin &nbsp; args &nbsp; [] &nbsp; where</div><div class="line added"><div class="ln lnA">312</div><div class="ln lnB">332</div>&nbsp;&nbsp;&nbsp;&nbsp; args &nbsp; = &nbsp; if &nbsp; null &nbsp; exts</div><div class="line added"><div class="ln lnA">312</div><div class="ln lnB">333</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; then &nbsp; ["diff",rev0++".."++rev1]</div><div class="line added"><div class="ln lnA">312</div><div class="ln lnB">334</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else &nbsp; ["diff",rev0++".."++rev1,"--"]++exts</div><div class="line unmodified"><div class="ln lnA">312</div><div class="ln lnB">335</div></div><div class="line unmodified"><div class="ln lnA">313</div><div class="ln lnB">336</div></div><div class="line unmodified"><div class="ln lnA">314</div><div class="ln lnB">337</div>-- &nbsp; | &nbsp; Processes &nbsp; diff &nbsp; output &nbsp; w/ &nbsp; bad &nbsp; words &nbsp; list &nbsp; `bw`</div><div class="range rangea"><b>FILE A: </b>317.. (8)</div><div class="range rangeb"><b>FILE B: </b>340.. (8)</div><div class="line unmodified"><div class="ln lnA">317</div><div class="ln lnB">340</div></div><div class="line unmodified"><div class="ln lnA">318</div><div class="ln lnB">341</div></div><div class="line unmodified"><div class="ln lnA">319</div><div class="ln lnB">342</div>-- &nbsp; | &nbsp; The &nbsp; same &nbsp; as &nbsp; gitdiff &nbsp; but &nbsp; returns &nbsp; HTML &nbsp; as &nbsp; IO &nbsp; String; &nbsp; `bw` &nbsp; is &nbsp; list &nbsp; of &nbsp; bad</div><div class="line deleted"><div class="ln lnA">320</div><div class="ln lnB">343</div>gitHtmlDiff &nbsp; :: &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; [String] &nbsp; -&gt; &nbsp; IO &nbsp; String</div><div class="line deleted"><div class="ln lnA">321</div><div class="ln lnB">343</div>gitHtmlDiff &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; gitbin &nbsp; bw &nbsp; =</div><div class="line deleted"><div class="ln lnA">322</div><div class="ln lnB">343</div>&nbsp;&nbsp; gitdiff &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; gitbin &nbsp; &gt;&gt;= &nbsp; return &nbsp; . &nbsp; procDiff &nbsp; bw &nbsp; &gt;&gt;= &nbsp; return &nbsp; . &nbsp; asHtml</div><div class="line added"><div class="ln lnA">323</div><div class="ln lnB">343</div>-- &nbsp; words, &nbsp; `exts` &nbsp; is &nbsp; the &nbsp; list &nbsp; of &nbsp; "*.extension" &nbsp; strings</div><div class="line added"><div class="ln lnA">323</div><div class="ln lnB">344</div>gitHtmlDiff &nbsp; :: &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; String &nbsp; -&gt; &nbsp; [String] &nbsp; -&gt; &nbsp; [String] &nbsp; -&gt; &nbsp; IO &nbsp; String</div><div class="line added"><div class="ln lnA">323</div><div class="ln lnB">345</div>gitHtmlDiff &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; gitbin &nbsp; bw &nbsp; exts &nbsp; =</div><div class="line added"><div class="ln lnA">323</div><div class="ln lnB">346</div>&nbsp;&nbsp; gitdiff &nbsp; rev0 &nbsp; <span class="highlight">rev1</span> &nbsp; gitbin &nbsp; exts &nbsp; &gt;&gt;= &nbsp; return &nbsp; . &nbsp; procDiff &nbsp; bw &nbsp; &gt;&gt;= &nbsp; return &nbsp; . &nbsp; asHtml</div><div class="line unmodified"><div class="ln lnA">323</div><div class="ln lnB">347</div>&nbsp;&nbsp; where &nbsp; asHtml &nbsp; ctx &nbsp; = &nbsp; (htmlHeader &nbsp; rev0 &nbsp; rev1)++showHtml &nbsp; ctx++htmlFooter</div></body></html>